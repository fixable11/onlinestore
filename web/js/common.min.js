$(function(){function e(e){var t=e.item.index;console.log(t);var o=e.item.count-1;t<0&&(t=o),t>o&&(t=0),_.find(".owl-item").removeClass("current").eq(t).addClass("current");var a=_.find(".owl-item.active").length-1,s=_.find(".owl-item.active").first().index();t>_.find(".owl-item.active").last().index()&&_.data("owl.carousel").to(t,100,!0),t<s&&_.data("owl.carousel").to(t-a,100,!0)}function t(e){if(console.log(e.item),u){var t=e.item.index;d.data("owl.carousel").to(t,100,!0)}}function o(e){$.ajax({type:"POST",async:!0,url:"/cart/addtocart/"+e+"/",dataType:"json",success:function(t){if(console.log(t),t.success){$(".basketCart__amount").text(t.cntItems);var o=$(".productAddToCart__add[data-id="+e+"]").addClass("productAddToCart__add-active");console.log(o),0==o.length?$(".productCart__addWrap").each(function(o,a){console.log(123),$(a).attr("data-id")==e&&($(a).addClass("productCart__addWrap-active"),$html='<div class="popupBasketCart__item" data-id="'+t.id+'"><a href="/product/'+t.id+'/" class="popupBasketCart__itemImgWrap"><img src="/web/img/products/'+t.image+'" alt="cart_img" class="popupBasketCart__itemImg"></a><h4 class="popupBasketCart__itemName">'+t.name+'</h4><div class="popupBasketCart__itemPrice" data-id="'+t.id+'" data-price="'+t.price+'">'+t.price+' грн</div><div class="popupBasketCart__itemAmountBox"><button class="popupBasketCart__itemAmountLess" data-id="'+t.id+'">-</button><div class="popupBasketCart__itemAmountWrap"><input type="text" maxlength="2" name="itemCnt_'+t.id+'" class="popupBasketCart__itemAmount" value="1" data-id="'+t.id+'"> шт.</div><button class="popupBasketCart__itemAmountMore" data-id="'+t.id+'">+</button></div><div class="popupBasketCart__itemRealPrice" data-id="'+t.id+'">'+t.price+' грн</div><button class="popupBasketCart__itemClose"><svg class="popupBasketCart__itemCloseImg"><use xlink:href="/web/img/vectorsprites/fa.svg#times" /></svg></button> </div>',$(".popupBasketCart__empty").remove(),$(".popupBasketCart__inner").append($html),$(".popupBasketCart__buttons").has("a").length||$(".popupBasketCart__buttons").append('<a href="#" class="popupBasketCart__cont">Продолжить покупки</a>').append('<button type="submit" class="popupBasketCart__checkout">Оформить заказ</button>'),$(".popupBasketCart").fadeIn(),$("#overlay").fadeIn(),$("body").css("overflow","hidden"))}):($html='<div class="popupBasketCart__item" data-id="'+t.id+'"><a href="/product/'+t.id+'/" class="popupBasketCart__itemImgWrap"><img src="/web/img/products/'+t.image+'" alt="cart_img" class="popupBasketCart__itemImg"></a><h4 class="popupBasketCart__itemName">'+t.name+'</h4><div class="popupBasketCart__itemPrice" data-id="'+t.id+'" data-price="'+t.price+'">'+t.price+' грн</div><div class="popupBasketCart__itemAmountBox"><button class="popupBasketCart__itemAmountLess" data-id="'+t.id+'">-</button><div class="popupBasketCart__itemAmountWrap"><input type="text" maxlength="2" name="amount" class="popupBasketCart__itemAmount" value="1" data-id="'+t.id+'"> шт.</div><button class="popupBasketCart__itemAmountMore" data-id="'+t.id+'">+</button></div><div class="popupBasketCart__itemRealPrice" data-id="'+t.id+'">'+t.price+' грн</div><button class="popupBasketCart__itemClose"><svg class="popupBasketCart__itemCloseImg"><use xlink:href="/web/img/vectorsprites/fa.svg#times" /></svg></button> </div>',$(".popupBasketCart__empty").remove(),$(".popupBasketCart__inner").append($html),$(".popupBasketCart__buttons").has("a").length||$(".popupBasketCart__buttons").append('<a href="#" class="popupBasketCart__cont">Продолжить покупки</a>').append('<button type="submit" class="popupBasketCart__checkout">Оформить заказ</button>'),$(".popupBasketCart").fadeIn(),$("#overlay").fadeIn(),$("body").css("overflow","hidden"),$(".productAddToCart__text").text("Товар добавлен в")),console.log(t)}},error:function(e,t,o){console.log(e.responseText),console.log(t),console.log(o)}})}function a(e){$.ajax({type:"POST",async:!0,url:"/cart/removefromcart/"+e+"/",dataType:"json",success:function(t){console.log(t),t.success&&($(".basketCart__amount").text(t.cntItems),$(".productAddToCart__add").removeClass("productAddToCart__add-active"),$(".productAddToCart__text").text("Добавить в"),$(".productCart__addWrap").each(function(t,o){$(o).attr("data-id")==e&&$(o).removeClass("productCart__addWrap-active")}),$(".popupBasketCart__inner").each(function(t,o){$('.popupBasketCart__item[data-id="'+e+'"]').remove(),0==$(".popupBasketCart__item").length&&($(".popupBasketCart__empty").length||$(".popupBasketCart__inner").append('<h4 class="popupBasketCart__empty">Ваша корзина пуста.</h4>'),$(".popupBasketCart__checkout").remove(),$(".popupBasketCart__cont").remove())}))},error:function(e,t,o){console.log(e.responseText),console.log(t),console.log(o)}})}function s(e){postData={},e.each(function(e,t){name=$(t).attr("name"),val=$(t).val(),postData[name]=val}),console.log(postData),$.ajax({type:"POST",async:!0,data:postData,url:"/user/register/",dataType:"json",success:function(e){if(console.log(e),e.success){if(alert("Регистрация прошла успешно!"),$(".registerBlock").removeClass("d-flex"),$(".registerBlock").addClass("d-none"),$(".userBlock").removeClass("d-none"),$(".userBlock").addClass("d-flex"),$(".popupRegisterBox__form input").css("border-color","#b5b5b5"),$(".popupRegisterBox").fadeOut(),$("#overlay").fadeOut(),$(".popupRegisterBox__form input").each(function(e,t){$(t).val("")}),$("body").css("overflow-y","auto"),$(".popupRegisterBox__message").html(""),0!=$(".orders__autho").length){$(".orders__autho").hide(),e.name||(e.name=""),e.phone||(e.phone=""),e.address||(e.address="");var t='<h3 class="orders__userTitle">Данные заказчика</h3><div class="orders__infoBox"><table class="orders__infoTable infoTable"><tr class="infoTable__tr"><td class="infoTable__td infoTable__td-first">ФИО</td><td class="infoTable__td infoTable__td-last"><input type="text" name="fio" class="infoTable__input infoTable__fio" value="'+e.name+'"></td></tr><tr class="infoTable__tr"> <td class="infoTable__td infoTable__td-first">Телефон</td><td class="infoTable__td infoTable__td-last"><input type="text" name="phone" class="infoTable__input infoTable__phone" value="'+e.phone+'"></td></tr><tr class="infoTable__tr"><td class="infoTable__td infoTable__td-first">Адрес</td><td class="infoTable__td infoTable__td-last"><textarea name="address" class="infoTable__textarea infoTable__address">'+e.address+"</textarea></td></tr></table></div>";$(".orders__totalLeft").append(t),$(".orders__pay").removeClass("orders__pay-inactive")}}else{var o=$(".popupRegisterBox__message");""!==o.html().trim()&&o.html(""),e.message.forEach(function(e,t){o.append('<li class="popupRegisterBox__messageItem">'+e+"</li>")})}},error:function(e,t,o){console.log(e.responseText),console.log(t),console.log(o)}})}function i(e){postData={},e.each(function(e,t){name=$(t).attr("name"),val=$(t).val(),postData[name]=val}),$.ajax({type:"POST",async:!0,data:postData,url:"/user/login/",dataType:"json",success:function(e){if(console.log(e),e.success){if($(".popupLoginBox__login,.popupLoginBox__pwd").css("border-color","#b5b5b5"),$(".registerBlock").removeClass("d-flex"),$(".registerBlock").addClass("d-none"),$(".userBlock").removeClass("d-none"),$(".userBlock").addClass("d-flex"),$(".popupLoginBox").fadeOut(),$("#overlay").fadeOut(),$(".popupLoginBox__form input").each(function(e,t){$(t).val("")}),$("body").css("overflow-y","auto"),0!=$(".orders__autho").length){$(".orders__autho").hide();var t='<h3 class="orders__userTitle">Данные заказчика</h3><div class="orders__infoBox"><table class="orders__infoTable infoTable"><tr class="infoTable__tr"><td class="infoTable__td infoTable__td-first">ФИО</td><td class="infoTable__td infoTable__td-last"><input type="text" name="fio" class="infoTable__input infoTable__fio" value="'+e.name+'"></td></tr><tr class="infoTable__tr"> <td class="infoTable__td infoTable__td-first">Телефон</td><td class="infoTable__td infoTable__td-last"><input type="text" name="phone" class="infoTable__input infoTable__phone" value="'+e.phone+'"></td></tr><tr class="infoTable__tr"><td class="infoTable__td infoTable__td-first">Адрес</td><td class="infoTable__td infoTable__td-last"><textarea name="address" class="infoTable__textarea infoTable__address">'+e.address+"</textarea></td></tr></table></div>";$(".orders__totalLeft").append(t),$(".orders__pay").removeClass("orders__pay-inactive")}$(".registerBlockMobile").html('<a href="/user/" class="loginBoxMobile loginBoxMobile-unlogin"><svg class="loginBoxMobile__user"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/web/img/vectorsprites/fa.svg#user"></use></svg></a>')}else{var o=$(".popupLoginBox__message");$(".popupLoginBox__login,.popupLoginBox__pwd").css("border-color","red"),e.message.forEach(function(e,t){o.html('<li class="popupLoginBox__messageItem">'+e+"</li>")})}},error:function(e,t,o){console.log(e.responseText),console.log(t),console.log(o)}})}function n(){$.ajax({type:"POST",async:!0,url:"/user/logout/",dataType:"json",success:function(e){console.log(e),e.success&&($(".userBlock").removeClass("d-flex"),$(".userBlock").addClass("d-none"),$(".registerBlock").removeClass("d-none"),$(".registerBlock").addClass("d-flex"),0!=$(".orders__totalLeft").length&&($(".orders__userTitle").remove(),$(".orders__infoBox").remove(),$(".orders__autho").fadeIn(),$(".orders__pay").addClass("orders__pay-inactive")))},error:function(e,t,o){console.log(e.responseText),console.log(t),console.log(o)}})}function r(e){postData={},e.each(function(e,t){name=$(t).attr("name"),val=$(t).val(),postData[name]=val}),console.log(postData),$.ajax({type:"POST",async:!0,data:postData,url:"/user/update/",dataType:"json",success:function(e){console.log(e),e.success,alert(e.message)},error:function(e,t,o){console.log(e.responseText),console.log(t),console.log(o)}})}function l(){var e=$(".infoTable__fio").val(),t=$(".infoTable__phone").val(),o=$(".infoTable__address").val(),a={fio:e,phone:t,address:o};$.ajax({type:"POST",async:!0,data:a,url:"/cart/saveorder/",dataType:"json",success:function(e){console.log(e),e.success?(alert(e.message),window.location.href="/"):alert(e.message)},error:function(e,t,o){console.log(e.responseText),console.log(t),console.log(o)}})}function p(e){var t=$('.popupBasketCart__itemAmount[data-id="'+e+'"]').val(),o=$('.popupBasketCart__itemPrice[data-id="'+e+'"]').attr("data-price"),a=t*o;a&&$('.popupBasketCart__itemRealPrice[data-id="'+e+'"]').text(a+" грн")}function c(e){$(".userOrderBox__tr[data-id="+e+"]").fadeToggle()}$(".sliderTopOwl").owlCarousel({loop:!0,responsiveClass:!1,nav:!0,dots:!0,navText:['<svg class="sliderTopOwl__angleLeft"><use xlink:href="/web/img/vectorsprites/fa.svg#angle-left" /></svg>','<svg class="sliderTopOwl__angleRight"><use xlink:href="/web/img/vectorsprites/fa.svg#angle-right" /></svg>'],responsive:{0:{items:1},1200:{items:1}}}),$(".bestSellersBox__owlWrap").owlCarousel({loop:!0,responsiveClass:!1,nav:!0,dots:!1,navText:['<svg class="bestSellersBox__angleLeft"><use xlink:href="/web/img/vectorsprites/fa.svg#angle-left" /></svg>','<svg class="bestSellersBox__angleRight"><use xlink:href="/web/img/vectorsprites/fa.svg#angle-right" /></svg>'],responsive:{0:{items:1},768:{items:2},992:{items:3},1200:{items:4}}});var d=$("#owl-sync"),_=$("#for-owl-sync"),u=!0;d.owlCarousel({items:1,slideSpeed:2e3,nav:!1,autoplay:!1,dots:!1,loop:!1,responsiveRefreshRate:200}).on("changed.owl.carousel",e),_.on("initialized.owl.carousel",function(){_.find(".owl-item").eq(0).addClass("current")}).owlCarousel({dots:!1,nav:!0,loop:!1,smartSpeed:200,slideSpeed:500,slideBy:1,responsiveRefreshRate:100,responsive:{0:{items:2},768:{items:3},992:{items:3},1200:{items:4}},navText:['<svg class="productSlider__arrowLeft" viewBox="0 0 11 20"><path style="fill:none;stroke-width: 1px;stroke: #000;" d="M9.554,1.001l-8.607,8.607l8.607,8.606"/></svg>','<svg class="productSlider__arrowRight" viewBox="0 0 11 20" version="1.1"><path style="fill:none;stroke-width: 1px;stroke: #000;" d="M1.054,18.214l8.606,-8.606l-8.606,-8.607"/></svg>']}).on("changed.owl.carousel",t),_.on("click",".owl-item",function(e){e.preventDefault();var t=$(this).index();d.data("owl.carousel").to(t,300,!0)}),$("select").each(function(){var e=$(this),t=$(this).children("option").length;e.addClass("select-hidden"),e.wrap('<div class="selectWrap"></div>'),e.after('<div class="select-styled"></div>');var o=e.next("div.select-styled");e.children("option").is(":selected")?o.text(e.children("option:selected").text()):o.text(e.children("option").eq(0).text());for(var a=$("<ul />",{class:"select-options"}).insertAfter(o),s=0;s<t;s++)$("<li />",{class:"select-option",text:e.children("option").eq(s).text(),rel:e.children("option").eq(s).val()}).appendTo(a);a.children("li");o.on("click",function(e){e.stopPropagation(),$("div.select-styled.active").not(this).each(function(){$(this).removeClass("active").next("ul.select-options").hide()}),$(this).toggleClass("active").next("ul.select-options").fadeToggle("slow")}),$(".select-options").on("click",".select-option",function(t){t.stopPropagation(),console.log($(this)),o.text($(this).text()).removeClass("active"),e.val($(this).attr("rel")),a.hide()}),$(document).click(function(){o.removeClass("active"),a.fadeOut("slow")})}),$(".accordionCategories__title").on("click",function(e){e.preventDefault(),$(this).next().slideToggle()}),$(".loginBox,.popupRegisterBox__autho, .orders__login, .loginBoxMobile-login").on("click",function(e){e.preventDefault(),$(".popupRegisterBox").hide(),$("#overlay").fadeIn(),$(".popupLoginBox").fadeIn(),$("body").css("overflow","hidden")}),$(".registerBox,.popupLoginBox__register, .orders__register").on("click",function(e){e.preventDefault(),$(".popupLoginBox").hide(),$("#overlay").fadeIn(),$(".popupRegisterBox").fadeIn(),$("body").css("overflow","hidden")}),$(".basketCart").on("click",function(e){e.preventDefault(),$("#overlay").fadeIn(),$(".popupBasketCart").fadeIn(),$("body").css("overflow","hidden")}),$("#overlay, .popupLoginBox__close,.popupRegisterBox__close, .popupBasketCart__close").on("click",function(e){$(this).attr("id")==$(e.target).attr("id")&&($(".popupLoginBox").fadeOut("400",function(){$("#overlay").fadeOut("100"),$("body").css("overflow-y","auto"),$(".popupLoginBox__login,.popupLoginBox__pwd").css("border-color","#b5b5b5").val(""),$(".popupLoginBox__message").html("")}),$(".popupRegisterBox").fadeOut("400",function(){$("#overlay").fadeOut("100"),$("body").css("overflow-y","auto"),$(".popupRegisterBox__login,.popupRegisterBox__pwd1,.popupRegisterBox__pwd2").css("border-color","#b5b5b5").val(""),$(".popupRegisterBox__message").html("")}),$(".popupBasketCart").fadeOut("400",function(){$("#overlay").fadeOut("100"),$("body").css("overflow-y","auto")}))}),$(".popupBasketCart__content").on("click",".popupBasketCart__cont",function(e){e.preventDefault(),$(".popupBasketCart").fadeOut("400",function(){$("#overlay").fadeOut("100"),$("body").css("overflow-y","auto")})}),$("#my-menu").mmenu({extensions:["pagedim-black"]},{offCanvas:{pageNodetype:".wrapper"}});var f=$("#my-menu").data("mmenu");$("#my-button").on("click",function(){f.open()}),$icon=$("#my-button"),f.bind("open:finish",function(){setTimeout(function(){$icon.addClass("is-active")},100)}),f.bind("close:finish",function(){setTimeout(function(){$icon.removeClass("is-active")},100)});var m=window.location.href.indexOf("filter"),v=window.location.href.substr(m);v=v.replace(/\//g," "),v=v.trim(),v=v.split(" "),v.shift(),v.pop(),$(".productsSet__brandsLable").each(function(e,t){var o=$(this).attr("data-symlink");~window.location.href.indexOf(o)&&$(this).find(".productsSet__brandsCheck").prop("checked",!0)}),$(".productsSet__brandsLable").on("change",function(e){var t=$(this).attr("data-parentcat"),o=$(this).attr("data-symlink"),a="";$(".productsSet__brandsLable").each(function(e,t){$(this).find(".productsSet__brandsCheck").prop("checked")&&(a+="/"+$(this).attr("data-symlink"))}),a=$(this).find(".productsSet__brandsCheck").prop("checked")?a?"/"+t+"/filter"+a+"/":"/"+t+"/filter/"+o+"/":a?"/"+t+"/filter"+a+"/":"/"+t+"/",console.log(a),window.location.href=a}),$(".productCart__addWrap, .productAddToCart__add").on("click",function(e){e.preventDefault(),o($(this).attr("data-id"))}),$(".popupBasketCart__inner").on("click",".popupBasketCart__itemClose",function(e){e.preventDefault(),a($(this).parent().attr("data-id"))}),$(".popupRegisterBox__register").on("click",function(e){e.preventDefault();var t=$(".popupRegisterBox__login").val(),o=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,a=$(".popupRegisterBox__message"),i=$(".popupRegisterBox__pwd1"),n=$(".popupRegisterBox__pwd2");t.length>0&&t.match(o)?(s($(".popupRegisterBox__form input")),$(".popupRegisterBox__login").css("border-color","#b5b5b5")):($(".popupRegisterBox__login").css("border-color","red"),a.html('<li class="popupRegisterBox__messageItem">*Введите корректный email</li>')),""!=i.val()&&""!=n.val()||(i.css("border-color","red"),n.css("border-color","red"),""===a.html().trim()?(a.html('<li class="popupRegisterBox__messageItem">*Введите пароль</li>'),a.append('<li class="popupRegisterBox__messageItem">*Введите повтор пароля</li>')):(a.append('<li class="popupRegisterBox__messageItem">*Введите пароль</li>'),a.append('<li class="popupRegisterBox__messageItem">*Введите повтор пароля</li>'))),i.val()!=n.val()&&(i.css("border-color","red"),n.css("border-color","red"),""===a.html().trim()?a.html('<li class="popupRegisterBox__messageItem">*Пароли не совпадают</li>'):a.append('<li class="popupRegisterBox__messageItem">*Пароли не совпадают</li>'))}),$(".popupLoginBox__entrance").on("click",function(e){e.preventDefault(),i($(".popupLoginBox__form input"))}),$(".userBlock__logout").on("click",function(e){e.preventDefault(),n()}),$(".userBox__logout").on("click",function(e){e.preventDefault(),n(),window.location.href="/"}),$(".userBlock__personal").on("click",function(e){e.preventDefault(),window.location.href="/user/"}),$(".userBox__save").on("click",function(e){e.preventDefault(),r($(".userBox__tr input, .userBox__tr textarea"))}),$(".orders__pay").on("click",function(e){l()}),$(".userOrderBox__showBtn").on("click",function(e){c($(this).attr("data-id"))}),$(".price__min").on("change",function(e){var t=+$(".price__max").val(),o=+$(this).val();console.log(o),console.log(t);var a=+$(".price__max").attr("data-max"),s=+$(this).attr("data-min");o<s?$(this).val(s):o>t?$(this).val(s):o<a&&$(this).val(o),Number.isInteger(o)||$(this).val(s)}),$(".price__max").on("change",function(e){var t=+$(this).val(),o=+$(".price__min").val(),a=+$(this).attr("data-max"),s=+$(".price__min").attr("data-min");t<s?$(this).val(s):t<o?$(this).val(o):t>a&&$(this).val(a),Number.isInteger(t)||$(this).val(a)}),$(".price__ok").on("click",function(e){var t=$(".price__min").val(),o=$(".price__max").val();if(t=parseInt(t),o=parseInt(o),!isNaN(t)&&!isNaN(o)){var a=window.location.href,s=/price=[0-9]+-[0-9]+/,i=/\/([a-z]+)\/filter/,n="/$1/price="+t+"-"+o+"/filter";a.match(s)?window.location.href=a.replace(s,"price="+t+"-"+o):-1!=a.search(/filter/)?window.location.href=a.replace(i,n):window.location.href=a+"price="+t+"-"+o+"/"}}),$(".popupBasketCart__inner").on("click",".popupBasketCart__itemAmountMore",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("data-id"),o=$('.popupBasketCart__itemAmount[data-id="'+t+'"]');amount=+o.val()+1,amount&&(o.val(amount),p(t))}),$(".popupBasketCart__inner").on("click",".popupBasketCart__itemAmountLess",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("data-id"),o=$('.popupBasketCart__itemAmount[data-id="'+t+'"]');amount=+o.val()-1,amount&&(o.val(amount),p(t))}),$(".popupBasketCart__itemAmount").on("change",function(e){p($(this).attr("data-id"))})});